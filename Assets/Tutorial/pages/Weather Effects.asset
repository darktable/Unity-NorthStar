%YAML 1.1
%TAG !u! tag:unity3d.com,2011:
--- !u!114 &11400000
MonoBehaviour:
  m_ObjectHideFlags: 0
  m_CorrespondingSourceObject: {fileID: 0}
  m_PrefabInstance: {fileID: 0}
  m_PrefabAsset: {fileID: 0}
  m_GameObject: {fileID: 0}
  m_Enabled: 1
  m_EditorHideFlags: 0
  m_Script: {fileID: 11500000, guid: 4510294d23d964fe59443526f1ca7c4b, type: 3}
  m_Name: Weather Effects
  m_EditorClassIdentifier: 
  m_displayName: Weather Effects
  m_hierarchyName: Weather Effects
  m_context: {fileID: 11400000, guid: 7ada8dafba80f394dbd5d80507599a4b, type: 2}
  m_markdownFile: {fileID: 0}
  m_priority: 1006
  m_overrideMarkdownText: '# Weather Effects


    ## Rain


    ### Rain Ripples


    NorthStar''s
    rain system includes rain ripples, a procedural shader-driven effect within the
    NorthStarDefaultShader function. To enable or disable rain ripples on compatible
    surfaces, configure the ripple settings using the Rain Data Scriptable object
    and add the Rain Controller Component to the scene.


    ![](./Images/WeatherEffects/Fig17.png)


    ###
    Optimization


    A procedural function reduces texture samples, offering control
    and reusability advantages over a texture flipbook approach. Procedural ripples
    allow variable density and intensity, optimizing the effect by removing ripple
    layers. For Quest 2 builds, rain ripples are halved.


    ### RainDrops


    Raindrops
    are a standalone Particle System, configured and placed as needed. Integration
    into the Rain Controller is ongoing.


    #### Optimization and Challenges


    In
    VR, clipping with the player camera is undesirable, especially with high-frequency
    effects like rain. NorthStar''s challenge is the perception of small geometry
    at a distance, making raindrops hard to read and contributing to fragment overdraw.
    Instead of fading particles near the camera, we implemented a dynamic solution
    that scales particle size by distance. When particles reach size 0, they move
    behind the player, reducing fragment overdraw and improving performance and readability.


    ###
    Wind


    NorthStar''s foliage shaders include wind as a procedural feature.
    Wind functions only when a Wind controller component is present, and models have
    the correct vertex color setup.


    #### Optimization


    The wind system
    uses multiple sine waves to simulate complex foliage movements.


    ## Geometry
    Vertex Colors Setup


    Two types of foliage are supported:


    ### Single
    Layer for Simple Foliage


    Single-layer foliage has a single motion channel,
    suitable for small clusters like grass or flowers.


    **Vertex Color Setup:**


    -
    R: Wind Influence (0-1).

    - G: None.

    - B: Random ID for leaf clusters.

    -
    A: None.


    Example:


    ![](./Images/WeatherEffects/Fig5.png)


    ###
    Double Layer for More Complex Foliage


    Used for foliage with primary and
    secondary motion sets, like NorthStar''s kelp in Beat 7, where leaves inherit
    stem motion and add complexity.


    **Vertex Color Setup:**


    - R: Stem:
    Black. Leaves: Wind Influence.

    - G: Stem: Wind Influence. Leaves: Stem Wind
    Influence.

    - B: Stem: None. Leaves: Random ID.

    - A: Stem: None. Leaves:
    None.


    Trunk:


    ![](./Images/WeatherEffects/Fig4.png)


    Wind parameters
    are stored in the Wind Data scriptable object, viewable in the Wind controller
    when populated.


    ![](./Images/WeatherEffects/Fig17.png)


    ## Asset Optimization


    The
    Docks scene in Beat 2, one of our most graphically intense scenes, required optimization
    due to high vertex counts. Techniques like LODs, imposters, and billboards were
    used, though not covered here as they are standard.


    In NorthStar, teleportation
    points define vertex density based on distance. With stationary navigation points,
    geometry reduction is aggressive until silhouettes show hard edges. Density decreases
    with distance.


    ![](./Images/WeatherEffects/Fig2.png)


    Red circles
    indicate player positions. To reduce draw calls and vertex count, the boat was
    divided into four parts based on player navigation.


    ![](./Images/WeatherEffects/Fig16.png)


    Each
    segment was baked into a single mesh with two materials: one for metal and one
    for non-metal parts. The LOD system supports manual switching to cheaper versions
    of the boat.


    ![](./Images/WeatherEffects/Fig8.png)


    Non-optimized
    geometry was excluded from custom LOD meshes.


    ## Shader System


    Most
    NorthStar shaders were created with Shader Graph, optimized for the Quest platform.


    ###
    Texture Configuration


    A custom texture packing setup reduces texture samples
    in NorthStar''s PBR shaders:


    - BaseColor Texture: RGB for Base Color, A
    for Opacity/Emissive.

    - Normal Texture: RG for Normal, G for Smoothness,
    B for Metallic/Ambient Occlusion/Height.


    Channels are packed by usefulness,
    benefiting from ASTC''s linear compression.


    ### Shaders


    An uber shader
    approach reduced shader maintenance and setup complexity. Disconnecting parameters
    like SmoothnessValue and MetallicValue from the shader graph saves 15% in instruction
    count, though not a direct performance increase. This basis led to a collection
    of shaders for common use cases.


    ![](./Images/WeatherEffects/Fig10.png)


    Shader
    functions maintain consistency, with the Uber shader function enabling/disabling
    features with constants for optimization.


    ![](./Images/WeatherEffects/Fig11.png)


    ###
    Material ShaderGUIs


    A custom shader inspector helps artists choose the
    right shaders. Assigning NorthStar PBR shaders uses this custom inspector.


    ![](./Images/WeatherEffects/Fig9.png)


    The
    Selected Shader dropdown provides informative choices and limits displayed information,
    centralizing shader options.


    ![](./Images/WeatherEffects/Fig14.png)


    Selecting
    a different shader updates the inspector with relevant options.


    PBR with
    smoothness:


    ![](./Images/WeatherEffects/Fig15.png)


    PBR Foliage:


    ![](./Images/WeatherEffects/Fig3.png)

'
  m_overrideMarkdownRoot: .\Documentation/
